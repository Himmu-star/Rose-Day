<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Rose for RuHi ‚Äî Rishu's Love</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600;700&family=Quicksand:wght@300;500;700&family=Pacifico&display=swap" rel="stylesheet">
    <style>
        :root {
            --dark-pink: #4a0e1c;
            --wine-red: #800f2f;
            --petal-pink: #ffb7c5;
            --glow-pink: #ff4d6d;
        }

        body {
            margin: 0;
            padding: 0;
            background: radial-gradient(circle at center, #800f2f 0%, #4a0e1c 100%);
            color: #ffd1dc;
            font-family: 'Quicksand', sans-serif;
            min-height: 200vh; /* To enable scroll for teddy popup */
            overflow-x: hidden;
        }

        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: auto;
        }

        /* UI Layer */
        .ui-layer {
            position: relative;
            z-index: 10;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 5vh;
        }

        .ui-layer * {
            pointer-events: auto;
        }

        /* Mouse Trail */
        .cursor-glow {
            width: 20px;
            height: 20px;
            background: var(--glow-pink);
            border-radius: 50%;
            position: fixed;
            pointer-events: none;
            filter: blur(15px);
            z-index: 9999;
            opacity: 0.6;
            transition: transform 0.1s ease-out;
        }

        /* 3D Rose Area Text */
        .rose-caption {
            font-family: 'Dancing Script', cursive;
            font-size: 1.8rem;
            text-align: center;
            margin-top: 65vh;
            color: #ffdae9;
            text-shadow: 0 0 10px rgba(255, 77, 109, 0.8);
            max-width: 80%;
            animation: pulseText 3s infinite ease-in-out;
        }

        @keyframes pulseText {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        /* Emotional Message Section */
        .message-section {
            margin-top: 20vh;
            background: rgba(74, 14, 28, 0.6);
            backdrop-filter: blur(10px);
            padding: 3rem 2rem;
            border-radius: 30px;
            border: 1px solid rgba(255, 77, 109, 0.3);
            max-width: 600px;
            text-align: center;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
        }

        .typewriter {
            font-family: 'Dancing Script', cursive;
            font-size: 1.5rem;
            line-height: 1.6;
            color: #ffdae9;
        }

        /* Teddy Section */
        #teddy-side {
            position: fixed;
            right: -150px;
            bottom: 100px;
            z-index: 100;
            transition: right 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
        }

        #teddy-side.active {
            right: 20px;
        }

        .teddy-bubble {
            position: absolute;
            bottom: 100px;
            right: 20px;
            background: white;
            color: #4a0e1c;
            padding: 10px 15px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9rem;
            width: 160px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.5s;
        }

        .teddy-bubble.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* Navigation Button */
        .next-btn {
            background: linear-gradient(45deg, #ff4d6d, #c9184a);
            color: white;
            padding: 15px 40px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.2rem;
            margin: 50px 0 100px;
            border: none;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 77, 109, 0.4);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .next-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 0 30px rgba(255, 77, 109, 0.7);
        }

        .next-btn:hover .heart-pop {
            animation: heartPop 0.6s forwards;
        }

        @keyframes heartPop {
            0% { transform: scale(1); }
            50% { transform: scale(1.5); }
            100% { transform: scale(1.2); }
        }

        /* Music Icon */
        .music-control {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 200;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: 0.3s;
        }

        .music-control:hover { background: rgba(255, 255, 255, 0.3); }

        /* Petals */
        .petal {
            position: fixed;
            top: -50px;
            z-index: 5;
            background: var(--petal-pink);
            border-radius: 0 100% 0 100%;
            opacity: 0.7;
            pointer-events: none;
            animation: fall linear infinite;
        }

        @keyframes fall {
            to { transform: translateY(105vh) translateX(100px) rotate(360deg); }
        }
    </style>
</head>
<body>

    <div id="cursor-glow" class="cursor-glow"></div>

    <div class="music-control" onclick="toggleMusic()">
        <span id="m-icon">üéµ</span>
        <audio id="floral-melody" loop>
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3" type="audio/mpeg">
        </audio>
    </div>

    <!-- 3D Rose Container -->
    <div id="canvas-container"></div>

    <div class="ui-layer">
        <p class="rose-caption">
            RuHi‚Ä¶ yeh rose bilkul waisa hi hai,<br>jaisa main aapko khud dena chahta hoon.
        </p>

        <div class="message-section">
            <p id="typewriter-text" class="typewriter"></p>
            <div style="height: 2px; width: 60%; background: var(--glow-pink); margin: 20px auto; box-shadow: 0 0 10px var(--glow-pink);"></div>
        </div>

        <button class="next-btn" onclick="location.href='mathflower.html'">
            Next Flower <span class="heart-pop">‚ù§Ô∏è</span>
        </button>
    </div>

    <!-- Teddy Popup -->
    <div id="teddy-side" onclick="waveTeddy()">
        <div id="teddy-bubble" class="teddy-bubble">Sona‚Ä¶ kya yeh rose pasand aaya? üåπüíó</div>
        <svg width="100" height="100" viewBox="0 0 100 100" id="teddy-svg">
            <circle cx="50" cy="40" r="20" fill="#d7ccc8" />
            <circle cx="35" cy="25" r="8" fill="#d7ccc8" />
            <circle cx="65" cy="25" r="8" fill="#d7ccc8" />
            <circle cx="45" cy="38" r="2" fill="#3e2723" />
            <circle cx="55" cy="38" r="2" fill="#3e2723" />
            <circle cx="50" cy="45" r="4" fill="#8d6e63" />
            <circle cx="50" cy="75" r="25" fill="#d7ccc8" />
            <!-- Wave Arm -->
            <path id="teddy-arm" d="M70 70 Q85 60 80 50" stroke="#d7ccc8" stroke-width="8" stroke-linecap="round" fill="none" />
        </svg>
    </div>

    <script>
        // --- THREE.JS 3D ROSE SIMULATION ---
        let scene, camera, renderer, roseGroup;

        function init3D() {
            scene = new THREE.Scene();
            camera = new THREE.Camera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('canvas-container').appendChild(renderer.domElement);

            // Lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);
            const spotLight = new THREE.SpotLight(0xff4d6d, 2);
            spotLight.position.set(5, 5, 5);
            scene.add(spotLight);

            // Simple 3D Rose Construction (Procedural)
            roseGroup = new THREE.Group();
            
            // Stem
            const stemGeom = new THREE.CylinderGeometry(0.05, 0.05, 3, 8);
            const stemMat = new THREE.MeshPhongMaterial({ color: 0x1b4332 });
            const stem = new THREE.Mesh(stemGeom, stemMat);
            stem.position.y = -1.5;
            roseGroup.add(stem);

            // Petals
            const petalMat = new THREE.MeshPhongMaterial({ 
                color: 0xff4d6d, 
                shininess: 100,
                side: THREE.DoubleSide 
            });
            
            for(let i = 0; i < 24; i++) {
                const petalGeom = new THREE.SphereGeometry(0.5, 32, 32, 0, Math.PI * 2, 0, Math.PI / 2);
                const petal = new THREE.Mesh(petalGeom, petalMat);
                
                const angle = (i / 8) * Math.PI * 2;
                const layer = Math.floor(i / 8);
                
                petal.scale.set(0.6 + layer*0.2, 1, 0.3 + layer*0.1);
                petal.rotation.z = Math.PI / 2 + (layer * 0.2);
                petal.rotation.y = angle;
                petal.position.y = 0.2 * layer;
                
                roseGroup.add(petal);
            }

            scene.add(roseGroup);

            // Interaction
            let isDragging = false;
            let previousMousePosition = { x: 0, y: 0 };

            window.addEventListener('mousedown', () => isDragging = true);
            window.addEventListener('mouseup', () => isDragging = false);
            window.addEventListener('mousemove', (e) => {
                if(isDragging) {
                    const deltaMove = {
                        x: e.offsetX - previousMousePosition.x,
                        y: e.offsetY - previousMousePosition.y
                    };
                    roseGroup.rotation.y += deltaMove.x * 0.01;
                    roseGroup.rotation.x += deltaMove.y * 0.01;
                }
                previousMousePosition = { x: e.offsetX, y: e.offsetY };
                
                // Cursor glow
                const glow = document.getElementById('cursor-glow');
                glow.style.left = e.clientX + 'px';
                glow.style.top = e.clientY + 'px';
            });

            // Zoom
            window.addEventListener('wheel', (e) => {
                camera.position.z += e.deltaY * 0.005;
                camera.position.z = Math.max(2, Math.min(camera.position.z, 10));
            });

            animate();
        }

        function animate() {
            requestAnimationFrame(animate);
            roseGroup.rotation.y += 0.005; // Auto-rotate
            renderer.render(scene, camera);
        }

        // --- PETALS ---
        function createPetals() {
            const colors = ['#ffb7c5', '#ff4d6d', '#c9184a'];
            for(let i=0; i<25; i++) {
                const petal = document.createElement('div');
                petal.className = 'petal';
                const size = Math.random() * 15 + 10 + 'px';
                petal.style.width = size;
                petal.style.height = size;
                petal.style.left = Math.random() * 100 + 'vw';
                petal.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
                petal.style.animationDuration = Math.random() * 5 + 5 + 's';
                petal.style.animationDelay = Math.random() * 5 + 's';
                document.body.appendChild(petal);
            }
        }

        // --- TYPEWRITER ---
        const message = "Main door hoon, par mera pyaar har roz aapke paas pahunchne ke liye koi na koi raasta dhoond hi leta hai. \n\n Yeh digital rose bhi unhi raaston me se ek hai‚Ä¶";
        let charIndex = 0;
        function typeEffect() {
            if(charIndex < message.length) {
                document.getElementById('typewriter-text').innerHTML += message.charAt(charIndex);
                charIndex++;
                setTimeout(typeEffect, 50);
            }
        }

        // --- TEDDY LOGIC ---
        window.addEventListener('scroll', () => {
            const teddy = document.getElementById('teddy-side');
            if(window.scrollY > 300) {
                teddy.classList.add('active');
                setTimeout(() => {
                    document.getElementById('teddy-bubble').classList.add('show');
                }, 1000);
            }
        });

        function waveTeddy() {
            const arm = document.getElementById('teddy-arm');
            arm.style.transition = "0.3s";
            arm.setAttribute('d', 'M70 70 Q95 80 90 60');
            setTimeout(() => {
                arm.setAttribute('d', 'M70 70 Q85 60 80 50');
            }, 3000);
        }

        let isPlaying = false;
        function toggleMusic() {
            const music = document.getElementById('floral-melody');
            const icon = document.getElementById('m-icon');
            if(!isPlaying) {
                music.play();
                icon.innerHTML = 'üîä';
            } else {
                music.pause();
                icon.innerHTML = 'üéµ';
            }
            isPlaying = !isPlaying;
        }

        window.onload = () => {
            init3D();
            createPetals();
            typeEffect();
        };

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
